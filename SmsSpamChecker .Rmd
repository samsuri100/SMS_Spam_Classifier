---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.1'
      jupytext_version: 1.2.4
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
import pandas as pd
import numpy as np

from nltk.tokenize import word_tokenize
from nltk.corpus import words

from sklearn.feature_extraction.text import CountVectorizer
from sklearn.feature_extraction.text import TfidfVectorizer

from sklearn.naive_bayes import MultinomialNB
from sklearn.linear_model import LogisticRegression

from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
```

```{python}
#Reading in spam sms dataset into memory
spamPath = '/home/samsuri/DataSets/SmsSpam/spam.csv'
df = pd.read_csv(spamPath, encoding="latin", usecols=[0,1], names=['classification', 'text'], skiprows=1)
df['text'] = df['text'].str.lower()
df.head()
```

```{python}
myDictionary = set()
for w in words.words():
    myDictionary.add(w.lower())

punctList = []
cleanedTextCorp = []

for index, row in df.iterrows():
    newTextList = []
    origTextList = word_tokenize(row['text'])
    
    tempPunctList = [(lambda s: 1 if '!' in s else 0)(origTextList),
                    (lambda s: 1 if '?' in s else 0)(origTextList)]
        
    for possibleWord in origTextList:
        if possibleWord in myDictionary:
            newTextList.append(possibleWord)
    
    punctList.append(tempPunctList)
    cleanedTextCorp.append(' '.join(newTextList)  )
```

```{python}
vec = CountVectorizer()
freqVec = vec.fit_transform(cleanedTextCorp)
cleanedDf = pd.DataFrame(freqVec.toarray(), columns=vec.get_feature_names())

npPunctList = np.array(punctList)
cleanedDf['!Bool'] = npPunctList[:,0]
cleanedDf['?Bool'] = npPunctList[:,0]
```

```{python}
classification = df['classification']
encodingDict = {'spam': 0, 'ham': 1}
classification = classification.replace(encodingDict)
xTrain, xTest, yTrain, yTest = train_test_split(cleanedDf, classification, test_size=.3, random_state=123)
```

```{python}
mnb = MultinomialNB()
mnb.fit(xTrain, yTrain)
accuracy_score(yTest, mnb.predict(xTest))
```

```{python}
lr = LogisticRegression()
lr.fit(xTrain, yTrain)
accuracy_score(yTest, lr.predict(xTest))
```

```{python}

```

```{python}

```

```{python}

```

```{python}
#Reading in spam sms dataset into memory
spamPath = '/home/samsuri/DataSets/SmsSpam/spam.csv'
df = pd.read_csv(spamPath, encoding="latin", usecols=[0,1], names=['classification', 'text'], skiprows=1)
df['text'] = df['text'].str.lower()
df.head(100)
```

```{python}
vec = CountVectorizer()
freqVec = vec.fit_transform(df['text'])
dfCount = pd.DataFrame(freqVec.toarray(), columns=vec.get_feature_names())
```

```{python}
classification = df['classification']
encodingDict = {'spam': 0, 'ham': 1}
classification.replace(encodingDict, inplace=True)
xTrain, xTest, yTrain, yTest = train_test_split(dfCount, classification, test_size=.3, random_state=123)
```

```{python}
mnb = MultinomialNB()
mnb.fit(xTrain, yTrain)
accuracy_score(yTest, mnb.predict(xTest))
```

```{python}
lr = LogisticRegression()
lr.fit(xTrain, yTrain)
accuracy_score(yTest, lr.predict(xTest))
```

```{python}

```
